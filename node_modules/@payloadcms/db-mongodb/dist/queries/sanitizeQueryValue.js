"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "sanitizeQueryValue", {
    enumerable: true,
    get: function() {
        return sanitizeQueryValue;
    }
});
const _mongoose = /*#__PURE__*/ _interop_require_default(require("mongoose"));
const _utilities = require("payload/utilities");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
const sanitizeQueryValue = ({ field, hasCustomID, operator, path, val })=>{
    let formattedValue = val;
    let formattedOperator = operator;
    // Disregard invalid _ids
    if (path === '_id' && typeof val === 'string' && val.split(',').length === 1) {
        if (!hasCustomID) {
            const isValid = _mongoose.default.Types.ObjectId.isValid(val);
            if (!isValid) {
                return {
                    operator: formattedOperator,
                    val: undefined
                };
            }
        }
        if (field.type === 'number') {
            const parsedNumber = parseFloat(val);
            if (Number.isNaN(parsedNumber)) {
                return {
                    operator: formattedOperator,
                    val: undefined
                };
            }
        }
    }
    // Cast incoming values as proper searchable types
    if (field.type === 'checkbox' && typeof val === 'string') {
        if (val.toLowerCase() === 'true') formattedValue = true;
        if (val.toLowerCase() === 'false') formattedValue = false;
    }
    if ([
        'all',
        'in',
        'not_in'
    ].includes(operator) && typeof formattedValue === 'string') {
        formattedValue = (0, _utilities.createArrayFromCommaDelineated)(formattedValue);
        if (field.type === 'number') {
            formattedValue = formattedValue.map((arrayVal)=>parseFloat(arrayVal));
        }
    }
    if (field.type === 'number' && typeof formattedValue === 'string') {
        formattedValue = Number(val);
    }
    if (field.type === 'date' && typeof val === 'string') {
        formattedValue = new Date(val);
        if (Number.isNaN(Date.parse(formattedValue))) {
            return undefined;
        }
    }
    if ([
        'relationship',
        'upload'
    ].includes(field.type)) {
        if (val === 'null') {
            formattedValue = null;
        }
        // Object equality requires the value to be the first key in the object that is being queried.
        if (operator === 'equals' && formattedValue && typeof formattedValue === 'object' && formattedValue.value && formattedValue.relationTo) {
            return {
                rawQuery: {
                    $and: [
                        {
                            [`${path}.value`]: {
                                $eq: formattedValue.value
                            }
                        },
                        {
                            [`${path}.relationTo`]: {
                                $eq: formattedValue.relationTo
                            }
                        }
                    ]
                }
            };
        }
        if (operator === 'in' && Array.isArray(formattedValue)) {
            formattedValue = formattedValue.reduce((formattedValues, inVal)=>{
                const newValues = [
                    inVal
                ];
                if (_mongoose.default.Types.ObjectId.isValid(inVal)) newValues.push(new _mongoose.default.Types.ObjectId(inVal));
                const parsedNumber = parseFloat(inVal);
                if (!Number.isNaN(parsedNumber)) newValues.push(parsedNumber);
                return [
                    ...formattedValues,
                    ...newValues
                ];
            }, []);
        }
    }
    // Set up specific formatting necessary by operators
    if (operator === 'near') {
        let lng;
        let lat;
        let maxDistance;
        let minDistance;
        if (Array.isArray(formattedValue)) {
            [lng, lat, maxDistance, minDistance] = formattedValue;
        }
        if (typeof formattedValue === 'string') {
            [lng, lat, maxDistance, minDistance] = (0, _utilities.createArrayFromCommaDelineated)(formattedValue);
        }
        if (lng == null || lat == null || maxDistance == null && minDistance == null) {
            formattedValue = undefined;
        } else {
            formattedValue = {
                $geometry: {
                    type: 'Point',
                    coordinates: [
                        parseFloat(lng),
                        parseFloat(lat)
                    ]
                }
            };
            if (maxDistance) formattedValue.$maxDistance = parseFloat(maxDistance);
            if (minDistance) formattedValue.$minDistance = parseFloat(minDistance);
        }
    }
    if (operator === 'within' || operator === 'intersects') {
        formattedValue = {
            $geometry: formattedValue
        };
    }
    if (path !== '_id' || path === '_id' && hasCustomID && field.type === 'text') {
        if (operator === 'contains') {
            formattedValue = {
                $options: 'i',
                $regex: formattedValue
            };
        }
    }
    if ((path === '_id' || path === 'parent') && operator === 'like' && formattedValue.length === 24 && !hasCustomID) {
        formattedOperator = 'equals';
    }
    if (operator === 'exists') {
        formattedValue = formattedValue === 'true' || formattedValue === true;
        // Clearable fields
        if ([
            'relationship',
            'select',
            'upload'
        ].includes(field.type)) {
            if (formattedValue) {
                return {
                    rawQuery: {
                        $and: [
                            {
                                [path]: {
                                    $exists: true
                                }
                            },
                            {
                                [path]: {
                                    $ne: null
                                }
                            }
                        ]
                    }
                };
            } else {
                return {
                    rawQuery: {
                        $or: [
                            {
                                [path]: {
                                    $exists: false
                                }
                            },
                            {
                                [path]: {
                                    $eq: null
                                }
                            }
                        ]
                    }
                };
            }
        }
    }
    return {
        operator: formattedOperator,
        val: formattedValue
    };
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9xdWVyaWVzL3Nhbml0aXplUXVlcnlWYWx1ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEZpZWxkLCBUYWJBc0ZpZWxkIH0gZnJvbSAncGF5bG9hZC90eXBlcydcblxuaW1wb3J0IG1vbmdvb3NlIGZyb20gJ21vbmdvb3NlJ1xuaW1wb3J0IHsgY3JlYXRlQXJyYXlGcm9tQ29tbWFEZWxpbmVhdGVkIH0gZnJvbSAncGF5bG9hZC91dGlsaXRpZXMnXG5cbnR5cGUgU2FuaXRpemVRdWVyeVZhbHVlQXJncyA9IHtcbiAgZmllbGQ6IEZpZWxkIHwgVGFiQXNGaWVsZFxuICBoYXNDdXN0b21JRDogYm9vbGVhblxuICBvcGVyYXRvcjogc3RyaW5nXG4gIHBhdGg6IHN0cmluZ1xuICB2YWw6IGFueVxufVxuXG5leHBvcnQgY29uc3Qgc2FuaXRpemVRdWVyeVZhbHVlID0gKHtcbiAgZmllbGQsXG4gIGhhc0N1c3RvbUlELFxuICBvcGVyYXRvcixcbiAgcGF0aCxcbiAgdmFsLFxufTogU2FuaXRpemVRdWVyeVZhbHVlQXJncyk6IHtcbiAgb3BlcmF0b3I/OiBzdHJpbmdcbiAgcmF3UXVlcnk/OiB1bmtub3duXG4gIHZhbD86IHVua25vd25cbn0gPT4ge1xuICBsZXQgZm9ybWF0dGVkVmFsdWUgPSB2YWxcbiAgbGV0IGZvcm1hdHRlZE9wZXJhdG9yID0gb3BlcmF0b3JcblxuICAvLyBEaXNyZWdhcmQgaW52YWxpZCBfaWRzXG4gIGlmIChwYXRoID09PSAnX2lkJyAmJiB0eXBlb2YgdmFsID09PSAnc3RyaW5nJyAmJiB2YWwuc3BsaXQoJywnKS5sZW5ndGggPT09IDEpIHtcbiAgICBpZiAoIWhhc0N1c3RvbUlEKSB7XG4gICAgICBjb25zdCBpc1ZhbGlkID0gbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQuaXNWYWxpZCh2YWwpXG5cbiAgICAgIGlmICghaXNWYWxpZCkge1xuICAgICAgICByZXR1cm4geyBvcGVyYXRvcjogZm9ybWF0dGVkT3BlcmF0b3IsIHZhbDogdW5kZWZpbmVkIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZmllbGQudHlwZSA9PT0gJ251bWJlcicpIHtcbiAgICAgIGNvbnN0IHBhcnNlZE51bWJlciA9IHBhcnNlRmxvYXQodmFsKVxuXG4gICAgICBpZiAoTnVtYmVyLmlzTmFOKHBhcnNlZE51bWJlcikpIHtcbiAgICAgICAgcmV0dXJuIHsgb3BlcmF0b3I6IGZvcm1hdHRlZE9wZXJhdG9yLCB2YWw6IHVuZGVmaW5lZCB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gQ2FzdCBpbmNvbWluZyB2YWx1ZXMgYXMgcHJvcGVyIHNlYXJjaGFibGUgdHlwZXNcbiAgaWYgKGZpZWxkLnR5cGUgPT09ICdjaGVja2JveCcgJiYgdHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHtcbiAgICBpZiAodmFsLnRvTG93ZXJDYXNlKCkgPT09ICd0cnVlJykgZm9ybWF0dGVkVmFsdWUgPSB0cnVlXG4gICAgaWYgKHZhbC50b0xvd2VyQ2FzZSgpID09PSAnZmFsc2UnKSBmb3JtYXR0ZWRWYWx1ZSA9IGZhbHNlXG4gIH1cblxuICBpZiAoWydhbGwnLCAnaW4nLCAnbm90X2luJ10uaW5jbHVkZXMob3BlcmF0b3IpICYmIHR5cGVvZiBmb3JtYXR0ZWRWYWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICBmb3JtYXR0ZWRWYWx1ZSA9IGNyZWF0ZUFycmF5RnJvbUNvbW1hRGVsaW5lYXRlZChmb3JtYXR0ZWRWYWx1ZSlcblxuICAgIGlmIChmaWVsZC50eXBlID09PSAnbnVtYmVyJykge1xuICAgICAgZm9ybWF0dGVkVmFsdWUgPSBmb3JtYXR0ZWRWYWx1ZS5tYXAoKGFycmF5VmFsKSA9PiBwYXJzZUZsb2F0KGFycmF5VmFsKSlcbiAgICB9XG4gIH1cblxuICBpZiAoZmllbGQudHlwZSA9PT0gJ251bWJlcicgJiYgdHlwZW9mIGZvcm1hdHRlZFZhbHVlID09PSAnc3RyaW5nJykge1xuICAgIGZvcm1hdHRlZFZhbHVlID0gTnVtYmVyKHZhbClcbiAgfVxuXG4gIGlmIChmaWVsZC50eXBlID09PSAnZGF0ZScgJiYgdHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHtcbiAgICBmb3JtYXR0ZWRWYWx1ZSA9IG5ldyBEYXRlKHZhbClcbiAgICBpZiAoTnVtYmVyLmlzTmFOKERhdGUucGFyc2UoZm9ybWF0dGVkVmFsdWUpKSkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZFxuICAgIH1cbiAgfVxuXG4gIGlmIChbJ3JlbGF0aW9uc2hpcCcsICd1cGxvYWQnXS5pbmNsdWRlcyhmaWVsZC50eXBlKSkge1xuICAgIGlmICh2YWwgPT09ICdudWxsJykge1xuICAgICAgZm9ybWF0dGVkVmFsdWUgPSBudWxsXG4gICAgfVxuXG4gICAgLy8gT2JqZWN0IGVxdWFsaXR5IHJlcXVpcmVzIHRoZSB2YWx1ZSB0byBiZSB0aGUgZmlyc3Qga2V5IGluIHRoZSBvYmplY3QgdGhhdCBpcyBiZWluZyBxdWVyaWVkLlxuICAgIGlmIChcbiAgICAgIG9wZXJhdG9yID09PSAnZXF1YWxzJyAmJlxuICAgICAgZm9ybWF0dGVkVmFsdWUgJiZcbiAgICAgIHR5cGVvZiBmb3JtYXR0ZWRWYWx1ZSA9PT0gJ29iamVjdCcgJiZcbiAgICAgIGZvcm1hdHRlZFZhbHVlLnZhbHVlICYmXG4gICAgICBmb3JtYXR0ZWRWYWx1ZS5yZWxhdGlvblRvXG4gICAgKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByYXdRdWVyeToge1xuICAgICAgICAgICRhbmQ6IFtcbiAgICAgICAgICAgIHsgW2Ake3BhdGh9LnZhbHVlYF06IHsgJGVxOiBmb3JtYXR0ZWRWYWx1ZS52YWx1ZSB9IH0sXG4gICAgICAgICAgICB7IFtgJHtwYXRofS5yZWxhdGlvblRvYF06IHsgJGVxOiBmb3JtYXR0ZWRWYWx1ZS5yZWxhdGlvblRvIH0gfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChvcGVyYXRvciA9PT0gJ2luJyAmJiBBcnJheS5pc0FycmF5KGZvcm1hdHRlZFZhbHVlKSkge1xuICAgICAgZm9ybWF0dGVkVmFsdWUgPSBmb3JtYXR0ZWRWYWx1ZS5yZWR1Y2UoKGZvcm1hdHRlZFZhbHVlcywgaW5WYWwpID0+IHtcbiAgICAgICAgY29uc3QgbmV3VmFsdWVzID0gW2luVmFsXVxuICAgICAgICBpZiAobW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQuaXNWYWxpZChpblZhbCkpXG4gICAgICAgICAgbmV3VmFsdWVzLnB1c2gobmV3IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkKGluVmFsKSlcblxuICAgICAgICBjb25zdCBwYXJzZWROdW1iZXIgPSBwYXJzZUZsb2F0KGluVmFsKVxuICAgICAgICBpZiAoIU51bWJlci5pc05hTihwYXJzZWROdW1iZXIpKSBuZXdWYWx1ZXMucHVzaChwYXJzZWROdW1iZXIpXG5cbiAgICAgICAgcmV0dXJuIFsuLi5mb3JtYXR0ZWRWYWx1ZXMsIC4uLm5ld1ZhbHVlc11cbiAgICAgIH0sIFtdKVxuICAgIH1cbiAgfVxuXG4gIC8vIFNldCB1cCBzcGVjaWZpYyBmb3JtYXR0aW5nIG5lY2Vzc2FyeSBieSBvcGVyYXRvcnNcblxuICBpZiAob3BlcmF0b3IgPT09ICduZWFyJykge1xuICAgIGxldCBsbmdcbiAgICBsZXQgbGF0XG4gICAgbGV0IG1heERpc3RhbmNlXG4gICAgbGV0IG1pbkRpc3RhbmNlXG5cbiAgICBpZiAoQXJyYXkuaXNBcnJheShmb3JtYXR0ZWRWYWx1ZSkpIHtcbiAgICAgIDtbbG5nLCBsYXQsIG1heERpc3RhbmNlLCBtaW5EaXN0YW5jZV0gPSBmb3JtYXR0ZWRWYWx1ZVxuICAgIH1cblxuICAgIGlmICh0eXBlb2YgZm9ybWF0dGVkVmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICA7W2xuZywgbGF0LCBtYXhEaXN0YW5jZSwgbWluRGlzdGFuY2VdID0gY3JlYXRlQXJyYXlGcm9tQ29tbWFEZWxpbmVhdGVkKGZvcm1hdHRlZFZhbHVlKVxuICAgIH1cblxuICAgIGlmIChsbmcgPT0gbnVsbCB8fCBsYXQgPT0gbnVsbCB8fCAobWF4RGlzdGFuY2UgPT0gbnVsbCAmJiBtaW5EaXN0YW5jZSA9PSBudWxsKSkge1xuICAgICAgZm9ybWF0dGVkVmFsdWUgPSB1bmRlZmluZWRcbiAgICB9IGVsc2Uge1xuICAgICAgZm9ybWF0dGVkVmFsdWUgPSB7XG4gICAgICAgICRnZW9tZXRyeTogeyB0eXBlOiAnUG9pbnQnLCBjb29yZGluYXRlczogW3BhcnNlRmxvYXQobG5nKSwgcGFyc2VGbG9hdChsYXQpXSB9LFxuICAgICAgfVxuXG4gICAgICBpZiAobWF4RGlzdGFuY2UpIGZvcm1hdHRlZFZhbHVlLiRtYXhEaXN0YW5jZSA9IHBhcnNlRmxvYXQobWF4RGlzdGFuY2UpXG4gICAgICBpZiAobWluRGlzdGFuY2UpIGZvcm1hdHRlZFZhbHVlLiRtaW5EaXN0YW5jZSA9IHBhcnNlRmxvYXQobWluRGlzdGFuY2UpXG4gICAgfVxuICB9XG5cbiAgaWYgKG9wZXJhdG9yID09PSAnd2l0aGluJyB8fCBvcGVyYXRvciA9PT0gJ2ludGVyc2VjdHMnKSB7XG4gICAgZm9ybWF0dGVkVmFsdWUgPSB7XG4gICAgICAkZ2VvbWV0cnk6IGZvcm1hdHRlZFZhbHVlLFxuICAgIH1cbiAgfVxuXG4gIGlmIChwYXRoICE9PSAnX2lkJyB8fCAocGF0aCA9PT0gJ19pZCcgJiYgaGFzQ3VzdG9tSUQgJiYgZmllbGQudHlwZSA9PT0gJ3RleHQnKSkge1xuICAgIGlmIChvcGVyYXRvciA9PT0gJ2NvbnRhaW5zJykge1xuICAgICAgZm9ybWF0dGVkVmFsdWUgPSB7ICRvcHRpb25zOiAnaScsICRyZWdleDogZm9ybWF0dGVkVmFsdWUgfVxuICAgIH1cbiAgfVxuXG4gIGlmIChcbiAgICAocGF0aCA9PT0gJ19pZCcgfHwgcGF0aCA9PT0gJ3BhcmVudCcpICYmXG4gICAgb3BlcmF0b3IgPT09ICdsaWtlJyAmJlxuICAgIGZvcm1hdHRlZFZhbHVlLmxlbmd0aCA9PT0gMjQgJiZcbiAgICAhaGFzQ3VzdG9tSURcbiAgKSB7XG4gICAgZm9ybWF0dGVkT3BlcmF0b3IgPSAnZXF1YWxzJ1xuICB9XG5cbiAgaWYgKG9wZXJhdG9yID09PSAnZXhpc3RzJykge1xuICAgIGZvcm1hdHRlZFZhbHVlID0gZm9ybWF0dGVkVmFsdWUgPT09ICd0cnVlJyB8fCBmb3JtYXR0ZWRWYWx1ZSA9PT0gdHJ1ZVxuXG4gICAgLy8gQ2xlYXJhYmxlIGZpZWxkc1xuICAgIGlmIChbJ3JlbGF0aW9uc2hpcCcsICdzZWxlY3QnLCAndXBsb2FkJ10uaW5jbHVkZXMoZmllbGQudHlwZSkpIHtcbiAgICAgIGlmIChmb3JtYXR0ZWRWYWx1ZSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJhd1F1ZXJ5OiB7XG4gICAgICAgICAgICAkYW5kOiBbeyBbcGF0aF06IHsgJGV4aXN0czogdHJ1ZSB9IH0sIHsgW3BhdGhdOiB7ICRuZTogbnVsbCB9IH1dLFxuICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcmF3UXVlcnk6IHtcbiAgICAgICAgICAgICRvcjogW3sgW3BhdGhdOiB7ICRleGlzdHM6IGZhbHNlIH0gfSwgeyBbcGF0aF06IHsgJGVxOiBudWxsIH0gfV0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7IG9wZXJhdG9yOiBmb3JtYXR0ZWRPcGVyYXRvciwgdmFsOiBmb3JtYXR0ZWRWYWx1ZSB9XG59XG4iXSwibmFtZXMiOlsic2FuaXRpemVRdWVyeVZhbHVlIiwiZmllbGQiLCJoYXNDdXN0b21JRCIsIm9wZXJhdG9yIiwicGF0aCIsInZhbCIsImZvcm1hdHRlZFZhbHVlIiwiZm9ybWF0dGVkT3BlcmF0b3IiLCJzcGxpdCIsImxlbmd0aCIsImlzVmFsaWQiLCJtb25nb29zZSIsIlR5cGVzIiwiT2JqZWN0SWQiLCJ1bmRlZmluZWQiLCJ0eXBlIiwicGFyc2VkTnVtYmVyIiwicGFyc2VGbG9hdCIsIk51bWJlciIsImlzTmFOIiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsImNyZWF0ZUFycmF5RnJvbUNvbW1hRGVsaW5lYXRlZCIsIm1hcCIsImFycmF5VmFsIiwiRGF0ZSIsInBhcnNlIiwidmFsdWUiLCJyZWxhdGlvblRvIiwicmF3UXVlcnkiLCIkYW5kIiwiJGVxIiwiQXJyYXkiLCJpc0FycmF5IiwicmVkdWNlIiwiZm9ybWF0dGVkVmFsdWVzIiwiaW5WYWwiLCJuZXdWYWx1ZXMiLCJwdXNoIiwibG5nIiwibGF0IiwibWF4RGlzdGFuY2UiLCJtaW5EaXN0YW5jZSIsIiRnZW9tZXRyeSIsImNvb3JkaW5hdGVzIiwiJG1heERpc3RhbmNlIiwiJG1pbkRpc3RhbmNlIiwiJG9wdGlvbnMiLCIkcmVnZXgiLCIkZXhpc3RzIiwiJG5lIiwiJG9yIl0sIm1hcHBpbmdzIjoiOzs7OytCQWFhQTs7O2VBQUFBOzs7aUVBWFE7MkJBQzBCOzs7Ozs7QUFVeEMsTUFBTUEscUJBQXFCLENBQUMsRUFDakNDLEtBQUssRUFDTEMsV0FBVyxFQUNYQyxRQUFRLEVBQ1JDLElBQUksRUFDSkMsR0FBRyxFQUNvQjtJQUt2QixJQUFJQyxpQkFBaUJEO0lBQ3JCLElBQUlFLG9CQUFvQko7SUFFeEIseUJBQXlCO0lBQ3pCLElBQUlDLFNBQVMsU0FBUyxPQUFPQyxRQUFRLFlBQVlBLElBQUlHLEtBQUssQ0FBQyxLQUFLQyxNQUFNLEtBQUssR0FBRztRQUM1RSxJQUFJLENBQUNQLGFBQWE7WUFDaEIsTUFBTVEsVUFBVUMsaUJBQVEsQ0FBQ0MsS0FBSyxDQUFDQyxRQUFRLENBQUNILE9BQU8sQ0FBQ0w7WUFFaEQsSUFBSSxDQUFDSyxTQUFTO2dCQUNaLE9BQU87b0JBQUVQLFVBQVVJO29CQUFtQkYsS0FBS1M7Z0JBQVU7WUFDdkQ7UUFDRjtRQUVBLElBQUliLE1BQU1jLElBQUksS0FBSyxVQUFVO1lBQzNCLE1BQU1DLGVBQWVDLFdBQVdaO1lBRWhDLElBQUlhLE9BQU9DLEtBQUssQ0FBQ0gsZUFBZTtnQkFDOUIsT0FBTztvQkFBRWIsVUFBVUk7b0JBQW1CRixLQUFLUztnQkFBVTtZQUN2RDtRQUNGO0lBQ0Y7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